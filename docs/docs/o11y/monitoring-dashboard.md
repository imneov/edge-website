# 监控仪表板

## 概述

监控仪表板是边缘计算平台可观测性模块的核心功能，提供实时监控集群、节点和应用性能指标的可视化界面。通过直观的图表和指标卡片，用户可以全面了解系统运行状态。

![监控仪表板概览](images/monitoring-dashboard-overview.png)

## 访问监控仪表板

### 导航路径

1. **从集群管理入口**
   - 导航到：`集群管理` → 选择目标集群 → `监控告警`
   - URL路径：`/boss/clusters/{cluster-id}/monitoring`

2. **从租户空间入口**
   - 导航到：`智能边缘平台` → 选择租户 → 选择集群 → `监控告警`
   - URL路径：`/tenant/{tenant-id}/clusters/{cluster-id}/monitoring`

### 界面布局

监控仪表板采用标签页（Tab）设计，分为三个主要视图：

1. **集群指标** - 实时资源使用情况
2. **告警** - 活跃告警和告警历史
3. **趋势图** - 历史趋势分析

## 集群指标监控

### 主要指标类型

#### 1. CPU 使用率

**显示内容**：
- 当前CPU使用百分比
- 进度条可视化显示
- 实时��据更新

**指标说明**：
- 计算范围：整个集群的CPU资源使用情况
- 数据来源：Prometheus + cAdvisor
- 采集间隔：默认15秒
- 计算方式：`CPU使用量 / CPU总量 × 100%`

**使用场景**：
- 识别CPU资源瓶颈
- 检测异常进程和负载
- 容量规划和资源优化

#### 2. 内存使用率

**显示内容**：
- 当前内存使用百分比
- 进度条可视化显示
- 实时数据更新

**指标说明**：
- 计算范围：集群总内存使用情况
- 包含：应用内存 + 系统内存 + 缓存
- 采集间隔：默认15秒
- 计算方式：`内存使用量 / 内存总量 × 100%`

**使用场景**：
- 内存泄漏检测
- 缓存效果评估
- 内存容量规划

#### 3. 磁盘使用率

**显示内容**：
- 磁盘使用百分比
- 进度条可视化显示
- 实时数据更新

**指标说明**：
- 监控所有节点的主要存储卷
- 包含：系统磁盘 + 数据卷
- 采集间隔：默认30秒
- 告警阈值：通常设置为80%

**使用场景**：
- 磁盘空间管理
- 日志清理策略制定
- 存储扩容规划

#### 4. 网络 I/O

**显示内容**：
- 入站流量：↓ 15.6 MB/s
- 出站流量：↑ 8.9 MB/s
- 实时数据更新

**指标说明**：
- 监控集群所有网络接口
- 单位：MB/s (兆字节/秒)
- 采集间隔：默认15秒
- 包含：Pod间通信 + 外部通信

**使用场景**：
- 网络带宽规划
- 网络性能优化
- 异常流量检测

### 实时监控特性

#### 自动刷新
- **刷新频率**：15-30秒自动刷新
- **手动刷新**：点击刷新按钮立即更新数据
- **暂停更新**：可以暂停实时更新以便分析

#### 数据聚合
- **集群级别**：聚合所有节点数据
- **时间窗口**：显示最近5分钟平均值
- **数据精度**：保留一位小数

#### 告警状态
- **正常状态**：绿色显示
- **警告状态**：黄色显示（超过70%）
- **严重状态**：红色显示（超过90%）

## 告警管理

### 告警视图

告警视图显示当前所有活跃的告警信息，帮助运维人员快速识别和处理问题。

![告警管理界面](images/monitoring-alerts-view.png)

### 告警信息结构

每个告警包含以下信息：

#### 1. 告警名称
- **高内存使用率** - 内存相关告警
- **磁盘空间不足** - 存储相关告警
- **CPU过载** - 计算资源告警
- **网络异常** - 网络相关告警

#### 2. 告警级别

**严重级别 (Critical)**：
- 红色标识
- 立即处理
- 示例：磁盘空间不足、服务完全不可用

**警告级别 (Warning)**：
- 黄色标识
- 尽快处理
- 示例：资源使用率过高、性能下降

#### 3. 告警状态

**活跃状态 (Firing)**：
- 告警条件持续满足
- 需要立即关注
- 显示为"正在触发"

**已解决状态 (Resolved)**：
- 告警条件不再满足
- 问题已解决
- 显示在历史记录中

#### 4. 告警描述

详细说明告警的具体情况：
- **高内存使用率**：节点内存使用率超过80%
- **磁盘空间不足**：存储卷剩余空间低于10%

#### 5. 触发时间

显示告警持续时间：
- **5m ago** - 5分钟前触发
- **15m ago** - 15分钟前触发
- **1h ago** - 1小时前触发

### 告警规则管理

#### 创建告警规则

点击右上角"创建告警规则"按钮，可以配置新的告警规则：

**配置步骤**：

1. **选择监控指标**
   - CPU、内存、磁盘、网络
   - 自定义Prometheus查询

2. **设置触发条件**
   - 阈值：大于/小于/等于指定值
   - 持续时间：条件满足多长时间触发

3. **配置告警级别**
   - Critical（严重）
   - Warning（警告）
   - Info（信息）

4. **设置通知方式**
   - 邮件通知
   - 短信通知
   - Webhook集成

#### 告警规则示例

**内存使用率告警**：
```yaml
条件: memory_usage_percent > 80
持续时间: 5分钟
级别: Warning
描述: "节点内存使用率超过80%"
```

**磁盘空间告警**：
```yaml
条件: disk_usage_percent > 90
持续时间: 10分钟
级别: Critical
描述: "磁盘空间不足，剩余低于10%"
```

### 告警处理流程

#### 1. 告警确认
- 查看告警详情
- 确认告警严重程度
- 评估影响范围

#### 2. 问题诊断
- 查看相关监控指标
- 分析系统日志
- 检查资源状态

#### 3. 故障处理
- 执行修复操作
- 监控处理效果
- 验证问题解决

#### 4. 告警关闭
- 确认问题解决
- 关闭告警通知
- 记录处理过程

## 趋势分析

### 趋势图功能

趋势图提供历史数据的可视化分析，帮助用户识别性能趋势和周期性模式。

### CPU 使用率趋势

**图表特性**：
- **时间范围**：显示24小时数据
- **数据点**：每小时一个数据点
- **图表类型**：折线图
- **颜色标识**：蓝色线条

**分析维度**：
- 峰值时段识别
- 负载周期模式
- 趋势方向判断
- 异常点检测

### 内存使用率趋势

**图表特性**：
- **时间范围**：显示24小时数据
- **数据点**：每小时一个数据点
- **图表类型**：折线图
- **颜色标识**：绿色线条

**分析维度**：
- 内存增长趋势
- 泄漏模式识别
- 缓存效果评估
- 容量规划依据

### 趋势图交互功能

#### 时间范围选择
- **1小时**：查看最近1小时详细数据
- **6小时**：查看半天数据趋势
- **24小时**：查看全天完整趋势
- **7天**：查看一周长期趋势
- **30天**：查看月度发展趋势

#### 数据缩放
- 鼠标滚轮缩放
- 拖拽选择时间段
- 双击重置视图

#### 悬停提示
- 显示具体数值
- 显示时间点
- 显示变化率

#### 图表导出
- PNG图片导出
- CSV数据导出
- 数据分享功能

## 监控最佳实践

### 1. 监控策略

#### 关键指标优先
- **必须监控**：CPU、内存、磁盘、网络
- **重点监控**：应用关键业务指标
- **按需监控**：根据业务特点添加特定指标

#### 合理设置阈值
- **警告阈值**：设置为正常最高值的80%
- **严重阈值**：设置为系统承受极限的90%
- **避免误报**：考虑业务高峰期的影响

### 2. 告警配置

#### 告警分级
- **P0级**：系统完全不可用，立即处理
- **P1级**：功能严重受损，1小时内处理
- **P2级**：性能下降，当天处理
- **P3级**：潜在风险，计划处理

#### 告警收敛
- **时间窗口**：5分钟内相同告警只发送一次
- **依赖抑制**：上游故障抑制下游告警
- **维护模式**：维护期间暂停非关键告警

### 3. 性能优化

#### 监控数据管理
- **数据保留**：详细数据保留7天，汇总数据保留30天
- **采集频率**：关键指标15秒，普通指标1分钟
- **存储优化**：使用时序数据库优化存储

#### 查询优化
- **时间范围**：避免查询过长时间范围
- **数据聚合**：使用预聚合数据
- **查询缓存**：缓存常用查询结果

### 4. 故障响应

#### 标准流程
1. **告警接收** → 确认告警级别
2. **初步判断** → 评估影响范围
3. **详细分析** → 查看监控指标和日志
4. **故障处理** → 执行修复操作
5. **效果验证** → 确认问题解决
6. **总结记录** → 更新知识库

#### 升级机制
- **5分钟未响应** → 通知上级主管
- **15分钟未解决** → 升级到技术负责人
- **30分钟未解决** → 升级到部门负责人

## 常见问题解答

### Q1: 监控数据延迟怎么办？

**可能原因**：
- 网络延迟
- 监控服务负载过高
- 数据采集间隔设置过长

**解决方法**：
1. 检查网络连接状态
2. 调整数据采集频率
3. 扩容监控服务资源
4. 优化Prometheus查询性能

### Q2: 告警过于频繁如何优化？

**优化策略**：
1. 调整告警阈值，避免过于敏感
2. 增加告警持续时间要求
3. 配置告警抑制规则
4. 使用告警聚合减少重复通知

### Q3: 如何自定义监控指标？

**实施步骤**：
1. 确定监控需求和指标定义
2. 在应用中暴露Metrics接口
3. 配置Prometheus采集规则
4. 创建监控面板和告警规则
5. 验证监控数据准确性

### Q4: 趋势图数据不准确？

**排查方法**：
1. 检查时间范围设置是否正确
2. 验证数据源连接状态
3. 确认Prometheus查询语法
4. 检查数据聚合和降采样配置
5. 对比多个数据源进行验证

## 相关功能

- [日志管理](./logging-management.md) - 系统日志查询和分析
- [链路追踪](./distributed-tracing.md) - 分布式调用链跟踪
- [性能分析](./performance-analysis.md) - 深度性能分析工具
- [告警配置](./alert-configuration.md) - 高级告警规则配置

---

**最后更新**：2026-01-08
**适用版本**：v1.0+
**维护团队**：Edge Platform Team